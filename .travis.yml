dist: trusty
sudo: false
language: node_js
node_js:
- 8.7.0
branches:
  except:
  - "/\\+travis\\.\\d+$/"
  - "/^\\d+\\.\\d+\\.\\d+-\\d+$/"
addons:
  apt:
    sources:
    - sourceline: "deb http://packages.cloudfoundry.org/debian stable main"
      key_url: "https://packages.cloudfoundry.org/debian/cli.cloudfoundry.org.key"
    packages:
    - cf-cli
env:
  global:
  - NPM_REGISTRY=https://atomist.jfrog.io/atomist/api/npm/npm-dev-local
  - secure: bz3asJvKfwgpTEit35x81c8lNJI1KBw+FaJoWMkaWtdXabgiSdOM1bnZz9rvsu3d4Gg3gcn6BvLmHdDi2N1gjAR2RIIE6zUbafibwb/Chs77Bhb00l2fbaONU0/IzhC9NiUzuS0ZFaCloDDmw53SiDSIIfo1z+2VT+5TYZJ7TIpRZQi+AtT3GYweViwa2ae9JcH/FYnpLAaV+Rzh6Sm6kE+l2GAFnxRok8oPA/r7ZQj01QVWidDPGPWkihb93C81ceIYyhyAFmjiN+NNevuRFgvsuISMjsUHNHfDuZKe/QqRCYT0TrqROdjhHeoANwussk045QQeHoS23f7rjB2F/KRDJR8PQ+MQE70ZVRf+AE3bogg4ek3gLGPNGyj4r7gEG9rd66jmSymsdLZc8V7kk5wNLU2lmRcJqaMIka0tTxBEjoNmmgYj0vPnwkytLBc8nBFciXoRKhwPolvHmSTlTmHPlb+QH5o1ufCZWK5+JrwvsWDysLdXBwXxRTVFM3DS+wrTk4M+ZxElrfECA9Ucq5KJd4ZWixarW90OxRJJafHlRtU25R09enU2KXZBoya3yqXnFaUI4jyOQ7NYMsP3CqPvrtgFmXn9kHNhIbuejLvgq3NLtLaOuijxy7FlMgWeduPrPdHDUd9q6Nrx+ip+8/gm9padq6FZ/H3ivRUmc8E=
  - secure: HCru52i5KyLAE21zTFcrsDuu4BIRRQtaYApjM7mRa8BRpsrtXL5hAHwYoR2WnsfxZsj7UVgRS3hsv+JcNKxNB1/2KMbduelzNpPblhMhKrOT7NQSD1F46IAlWjbO9eV4h+aHE9aCFuxoWEwlyQ28kDF+x8Pp6Ku8mPBe+offh0PspsNtK37gL5PnVH4VdV1+p01GSVS/rZMuvZ6fUKaE8q/KEjKOettXqknCQyfERBPT9RqJyohtVobrLC8Fz8dTtItPpT20slJsviAyJH07NpqJlWRtJP4oojDsN81XuRUamchFrw4/GiYbzSkSuTp5RVZztyQzpByzivyIfW8dwpguz/wQ5lYWTjd1pChknXX7OLXShjsdmXOSTcQuQ+e9vNlbWx1RPBs0TO4cQOT6E2AMqaanIf0byqdgNXl4LSmI1RcWX5IMS8ylsfYm3KMyDTZ8qegTa0EcZhLqIDacaKb08RDk0ViGk6lmztWKIYCwe3fK7/mml/3GD+hJHk5Pta6ruw7Ej3EXjthEXRL0KKOblvhgtEEqLdKAIBjonVnsAvBxJXGOkukIGf1KcrbnmsSO/nH9UcAW2baD5rH6WlYrtrk2dZZBFc4DmW37pPutYa5LN7KqCZrDug9/wJcKZke8mXq+iWd5qp4hxjfLCLveEuRjYPasfas/vaqCXeE=
  - secure: bX/ZOQQEI+mHQwwwGRTDxU0/1JB0LpaNY794IVMYKzjjtoeLT1CQhAg6oPmcLdsDkXFh0U93o/hOoyGK+Esg8X5lPtEGGghxMrsamLEvYmYSRrdUJtFk8KcRHk6BVmbKs57JRzxVm/bUfzo24Nrr+wkWSQKNp6DjVhjr/o64rzkLA6UKoLQY7wuSVWd0FrtUDFxiZsVinqXEcTsbF0FJe5tor1RSW4qzQGEuRb5PEltsFFz9DNt5UkHgQvSvWVP7Lec7ktA60O+uL+G8xfTqj4HK7Z+COwIy3SyYdTM4KJzNaHPPAc2cAUJhH7xVAg+TpZ0B2AhwaQhaTdo6giho57gYjXbQ5OtDRSDYsOqg8BIsZu1e3THwqmLrWkCFeW21U72ix13O2QSC3vaTkhvln6VSlih23dJmRt3t8h84wYv+CvVXvedJc0gOTrjDppAYtkNJTVxZGUWDuB7Sknt5EJqImSvr7sgaek2URhLYyogujpvImgOY/AcDhs5yPYWfrhh2Wv/VzBWqVKz8V1Yy6Y9onz9ITlPqEoFCUIJo9C3jHCDBTub/2C/DHyzWHrIAaCw7FLHqbOKvxyXLkPIegQoySBhs2StGRQs71qeerKTIVxjkCDWamfNj+rEVeyvhCl3QsSD4xQ3uLTkoFMt+FRuWUyL5UfVvX5T2SEusHko=
  - CF_ORG=atomist
before_install:
- "rm -f $HOME/.npm/_logs/*-debug.log"
- openssl aes-256-cbc -K $encrypted_f1d3e3be3628_key -iv $encrypted_f1d3e3be3628_iv
  -in scripts/.npmrc.enc -out $HOME/.npmrc -d
script: bash scripts/travis-build.bash
notifications:
  email: false
  webhooks:
    urls:
    - https://webhook.atomist.com/atomist/travis/teams/T29E48P34
    on_success: always
    on_failure: always
    on_start: always
    on_cancel: always
    on_error: always
cache:
  directories:
  - "$HOME/.npm"
deploy:
- provider: pages
  skip_cleanup: true
  github_token: "$GITHUB_TOKEN"
  local_dir: build/typedoc
  on:
    tags: true
    condition: "$TRAVIS_TAG =~ ^[0-9]+\\.[0-9]+\\.[0-9]+(-(m|rc)\\.[0-9]+)?$"
- provider: releases
  api_key: "$GITHUB_TOKEN"
  on:
    tags: true
    condition: "$TRAVIS_TAG =~ ^[0-9]+\\.[0-9]+\\.[0-9]+(-(m|rc)\\.[0-9]+)?$"
